<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script src = "https://cdn.rawgit.com/greggman/twgl.js/master/dist/4.x/twgl-full.min.js" type="text/javascript"></script>
    <script src = "https://webglfundamentals.org/webgl/resources/m3.js"></script>
  </head>
  <body>

    <canvas id="canvas"></canvas>
  </body>
  <!-- vertex shader -->
  <script id="vs" type="f">
    attribute vec2 position;
    attribute vec2 texcoord;

    uniform mat3 u_matrix;

    varying vec2 v_texcoord;

    void main() {
       gl_Position = vec4(u_matrix * vec3(position, 1), 1);
       v_texcoord = texcoord;
    }
  </script>

  <!-- fragment shader -->
  <script id="fs" type="f">
    precision mediump float;

    uniform vec2 u_mouse;

    uniform sampler2D u_originalImage;
    uniform sampler2D u_mapImage;

    varying vec2 v_texcoord;

    void main() {
       vec4 depthDistortion = texture2D(u_mapImage, v_texcoord);
       float parallaxMult = depthDistortion.r;

       vec2 parallax = (u_mouse) * parallaxMult;

       vec4 original = texture2D(u_originalImage, (v_texcoord + parallax));
       gl_FragColor = original;
    }
  </script>
  <script src = "./main.js"></script>
  <style>
    canvas {
      height: 100%;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      min-width: 100vw;
      min-height: 100vw;
    }
  </style>
</html>
